<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
    
	<title>http_ReadNotes-04 - Amorki&#39;s</title>
    <meta name="author" content="">
    
	<meta name="description" content="&lt;h1 id=&#34;V-与HTTP协作的Web服务器&#34;&gt;&lt;a href=&#34;#V-与HTTP协作的Web服务器&#34; class=&#34;headerlink&#34; title=&#34;V. 与HTTP协作的Web服务器&#34;&gt;&lt;/a&gt;V. 与HTTP协作的Web服务器&lt;/h1&gt;&lt;p&gt;一台 Web 服务器可搭建多个独立域名的 Web 网站，也可作为通信路 径上的中转服务器提升传输效率。&lt;/p&gt;
&lt;h2 id=&#34;5-1-用单台虚拟主机实现多个域名&#34;&gt;&lt;a href=&#34;#5-1-用单台虚拟主机实现多个域名&#34; class=&#34;headerlink&#34; title=&#34;5.1 用单台虚拟主机实现多个域名&#34;&gt;&lt;/a&gt;&lt;strong&gt;5.1&lt;/strong&gt; 用单台虚拟主机实现多个域名&lt;/h2&gt;&lt;p&gt;HTTP/1.1 规范允许一台 HTTP 服务器搭建多个 Web 站点。&lt;/p&gt;
&lt;p&gt;提供 Web 托管服务(Web Hosting Service)的供应商，可以用一台服务器为多位客户服务，也可以以每位客户持有的域名运行各自不同的网站。这是因为利用了&lt;code&gt;虚拟主机&lt;/code&gt;(Virtual Host，又称虚拟服务器)的功能。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://tva1.sinaimg.cn/large/007S8ZIlly1gfopwi7vkgj30i30d5dgt.jpg&#34;&gt;&lt;/p&gt;
&lt;p&gt;客户端使用 HTTP 协议访问服务器时，会经常采用类似 &lt;a href=&#34;http://www.hackr.jp/&#34;&gt;www.hackr.jp&lt;/a&gt; 这样的主机名和域名。&lt;/p&gt;
&lt;p&gt;在互联网上，域名通过 DNS 服务映射到 IP 地址(域名解析)之后访问目标网站。&lt;/p&gt;
&lt;p&gt;当请求发送到服务器时，已经是以 IP 地址形式访问了。&lt;/p&gt;
&lt;p&gt;所以，如果一台服务器内托管了 &lt;a href=&#34;http://www.tricorder.jp/&#34;&gt;www.tricorder.jp&lt;/a&gt; 和 &lt;a href=&#34;http://www.hackr.jp/&#34;&gt;www.hackr.jp&lt;/a&gt; 这 两个域名，当收到请求时就需要弄清楚究竟要访问哪个域名。&lt;/p&gt;
&lt;p&gt;在相同的 IP 地址下，由于虚拟主机可以寄存多个不同主机名和域名 的 Web 网站，因此在发送 HTTP 请求时，必须在 Host 首部内完整指 定主机名或域名的 URI。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://tva1.sinaimg.cn/large/007S8ZIlly1gfopyxahuqj30ev09omxy.jpg&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;5-2-通信数据转发程序-代理、网关、隧道&#34;&gt;&lt;a href=&#34;#5-2-通信数据转发程序-代理、网关、隧道&#34; class=&#34;headerlink&#34; title=&#34;5.2 通信数据转发程序 :代理、网关、隧道&#34;&gt;&lt;/a&gt;&lt;strong&gt;5.2&lt;/strong&gt; 通信数据转发程序 :代理、网关、隧道&lt;/h2&gt;&lt;p&gt;HTTP 通信时，除客户端和服务器以外，还有一些用于&lt;code&gt;通信数据转发的应用程序&lt;/code&gt;可以配合服务器工作。&lt;/p&gt;
&lt;p&gt;将请求转发给通信线路上的下一站服务器，并且能接收从那台服务器发送的响应再转发给客户端。&lt;/p&gt;
&lt;h3 id=&#34;代理&#34;&gt;&lt;a href=&#34;#代理&#34; class=&#34;headerlink&#34; title=&#34;代理&#34;&gt;&lt;/a&gt;代理&lt;/h3&gt;&lt;p&gt;代理是一种&lt;code&gt;有转发功能的应用程序&lt;/code&gt;，它扮演了位于服务器和客户端“中间人”的角色，接收由客户端发送的请求并转发给服务器，同时 也接收服务器返回的响应并转发给客户端。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;代理不改变请求 URI，会直接发送给前方持有资源的目标服务器。&lt;/li&gt;
&lt;li&gt;持有资源实体的服务器被称为源服务器。从源服务器返回的响应经过 代理服务器后再传给客户端。&lt;/li&gt;
&lt;li&gt;在 HTTP 通信过程中，可级联多台代理服务器。请求和响应的转发会 经过数台类似锁链一样连接起来的代理服务器。&lt;/li&gt;
&lt;li&gt;转发时，需要附加 Via 首部字段以标记出经过的主机信息。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://tva1.sinaimg.cn/large/007S8ZIlly1gfoq5962glj30jl07d0tk.jpg&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://tva1.sinaimg.cn/large/007S8ZIlly1gfoq6k52ppj30j2084q42.jpg&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://tva1.sinaimg.cn/large/007S8ZIlly1gfoq7m3detj30g4079wf1.jpg&#34;&gt;&lt;/p&gt;
&lt;p&gt;使用代理服务器的理由:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;利用缓存技术减少网络带宽的流量，&lt;/li&gt;
&lt;li&gt;组织内部针对特定网站的访问控制，以获取访问日志为主要目的&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;代理有多种使用方法：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;是否使用缓存&lt;/li&gt;
&lt;li&gt;是否会修改报文&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;code&gt;缓存代理&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;代理转发响应时，缓存代理(Caching Proxy)会预先将资源的副本 (缓存)保存在代理服务器上。&lt;/p&gt;
&lt;p&gt;当代理再次接收到对相同资源的请求时，就可以不从源服务器那里获取资源，而是将之前缓存的资源作为响应返回。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;透明代理&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;转发请求或响应时，不对报文做任何加工的代理类型被称为透明代理 (Transparent Proxy)。反之，对报文内容进行加工的代理被称为非 透明代理。&lt;/p&gt;
&lt;h3 id=&#34;网关&#34;&gt;&lt;a href=&#34;#网关&#34; class=&#34;headerlink&#34; title=&#34;网关&#34;&gt;&lt;/a&gt;网关&lt;/h3&gt;&lt;p&gt;网关是&lt;code&gt;转发其他服务器通信数据的服务器&lt;/code&gt;，接收从客户端发送来的请求时，它就像自己拥有资源的源服务器一样对请求进行处理。有时客户端可能都不会察觉，自己的通信目标是一个网关。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;网关能使通信线路上的服务器提供非 HTTP 协议服务。&lt;/li&gt;
&lt;li&gt;利用网关能提高通信的安全性，在客户端与网关之间的通信线路上加密确保连接的安全。&lt;/li&gt;
&lt;li&gt;网关可以连接数据库，使用 SQL 语句查询数据。&lt;/li&gt;
&lt;li&gt;在 Web 购物网站上进行信用卡结算时， 网关可以和信用卡结算系统联动。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://tva1.sinaimg.cn/large/007S8ZIlly1gfoq9mopetj30ii05jdg7.jpg&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;隧道&#34;&gt;&lt;a href=&#34;#隧道&#34; class=&#34;headerlink&#34; title=&#34;隧道&#34;&gt;&lt;/a&gt;隧道&lt;/h3&gt;&lt;p&gt;隧道是在&lt;code&gt;相隔甚远的客户端和服务器两者之间进行中转&lt;/code&gt;，并保持双方通信连接的应用程序。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;届时使用 SSL 等加密手段进行通信。&lt;/li&gt;
&lt;li&gt;目的是确保客户端能与服务器进行安全的通信。&lt;/li&gt;
&lt;li&gt;隧道本身不会去解析 HTTP 请求。—–请求保持原样中转给之后的服务器。&lt;/li&gt;
&lt;li&gt;隧道会在通信双方断开连接时结束。&lt;/li&gt;
&lt;li&gt;隧道本身是透明的，客户端不用在意隧道的存在&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://tva1.sinaimg.cn/large/007S8ZIlly1gfoqfvvnzoj30j204fwes.jpg&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;5-3-保存资源的缓存&#34;&gt;&lt;a href=&#34;#5-3-保存资源的缓存&#34; class=&#34;headerlink&#34; title=&#34;5.3 保存资源的缓存&#34;&gt;&lt;/a&gt;&lt;strong&gt;5.3&lt;/strong&gt; 保存资源的缓存&lt;/h2&gt;&lt;p&gt;&lt;code&gt;缓存&lt;/code&gt;——代理服务器或客户端本地磁盘内保存的资源副本。&lt;/p&gt;
&lt;p&gt;利用缓存可减少对源服务器的访问，节省通信流量和通信时间。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;缓存服务器&lt;/code&gt;是代理服务器的一种，并归类在缓存代理类型中。&lt;/p&gt;
&lt;p&gt;当代理转发从服务器返回的响应时，代理服务器将会保存一份资 源的副本。&lt;/p&gt;
&lt;p&gt;利用缓存可避免多次从源服务器转发资源。&lt;/p&gt;
&lt;p&gt;客户端可就近从缓存服务器上获取资源，而源服务器也不必多次处 理相同的请求了。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://tva1.sinaimg.cn/large/007S8ZIlly1gfoqjp2bohj30jr0hlwg7.jpg&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;5-3-1-缓存的有效期限&#34;&gt;&lt;a href=&#34;#5-3-1-缓存的有效期限&#34; class=&#34;headerlink&#34; title=&#34;5.3.1 缓存的有效期限&#34;&gt;&lt;/a&gt;&lt;strong&gt;5.3.1&lt;/strong&gt; 缓存的有效期限&lt;/h3&gt;&lt;p&gt;&lt;img src=&#34;https://tva1.sinaimg.cn/large/007S8ZIlly1gfoql8swl0j30jm0amjsa.jpg&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;5-3-2-客户端的缓存&#34;&gt;&lt;a href=&#34;#5-3-2-客户端的缓存&#34; class=&#34;headerlink&#34; title=&#34;5.3.2 客户端的缓存&#34;&gt;&lt;/a&gt;&lt;strong&gt;5.3.2&lt;/strong&gt; 客户端的缓存&lt;/h3&gt;&lt;p&gt;缓存不仅可以存在于缓存服务器内，还可以存在客户端浏览器中。&lt;/p&gt;
&lt;p&gt;以 &lt;code&gt;Internet Explorer&lt;/code&gt; 程序为例，把客户端缓存称为&lt;code&gt;临时网络文件&lt;/code&gt; (Temporary Internet File)。&lt;/p&gt;
&lt;p&gt;浏览器缓存如果有效，就不必再向服务器请求相同的资源了，可以直 接从本地磁盘内读取。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://tva1.sinaimg.cn/large/007S8ZIlly1gfoqmly6c7j30dz0a2mxm.jpg&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;在-HTTP-出现之前的协议&#34;&gt;&lt;a href=&#34;#在-HTTP-出现之前的协议&#34; class=&#34;headerlink&#34; title=&#34;在 HTTP 出现之前的协议&#34;&gt;&lt;/a&gt;在 &lt;strong&gt;HTTP&lt;/strong&gt; 出现之前的协议&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;在 HTTP 普及之前，也就是从互联网的诞生期至今，曾出现过各式各样的协议。在 HTTP 规范确立之际，制定者们参考了那些协议的 功能。也有某些协议现在已经彻底退出了人们的视线。接下来，简单介绍一下这些协议。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;FTP&lt;/strong&gt;(&lt;strong&gt;File Transfer Protocol&lt;/strong&gt;)&lt;/p&gt;
&lt;p&gt;传输文件时使用的协议。该协议历史久远，可追溯到 1973 年前 后，比 TCP/IP 协议族的出现还要早。虽然它在 1995 年被 HTTP 的 流量(Traffic)超越，但时至今日，仍被广泛沿用。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;NNTP&lt;/strong&gt;(&lt;strong&gt;Network News Transfer Protocol&lt;/strong&gt;)&lt;/p&gt;
&lt;p&gt;用于 NetNews 电子会议室内传送消息的协议。在 1986 年前后出 现，属于比较古老的一类协议。现在，利用 Web 交换信息已成主 流，所以该协议已经不怎么使用了。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Archie&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;搜索 anonymous FTP 公开的文件信息的协议。1990 年前后出现，现 在已经不常使用。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;WAIS&lt;/strong&gt;(&lt;strong&gt;Wide Area Information Servers&lt;/strong&gt;) 以关键词检索多个数据库使用的协议。1991 年前后出现。由于现&lt;/p&gt;
&lt;p&gt;在已经被 HTTP 协议替代，也已经不怎么使用了。 &lt;strong&gt;G o phe r&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;查找与互联网连接的计算机内信息的协议。1991 年前后出现，由 于现在已经被 HTTP 协议替代，也已经不怎么使用了。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&#34;VI-HTTP-首部&#34;&gt;&lt;a href=&#34;#VI-HTTP-首部&#34; class=&#34;headerlink&#34; title=&#34;VI. HTTP 首部&#34;&gt;&lt;/a&gt;VI. HTTP 首部&lt;/h1&gt;&lt;h2 id=&#34;6-1-HTTP-报文首部&#34;&gt;&lt;a href=&#34;#6-1-HTTP-报文首部&#34; class=&#34;headerlink&#34; title=&#34;6.1 HTTP 报文首部&#34;&gt;&lt;/a&gt;&lt;strong&gt;6.1&lt;/strong&gt; &lt;strong&gt;HTTP&lt;/strong&gt; 报文首部&lt;/h2&gt;&lt;p&gt;&lt;img src=&#34;https://tva1.sinaimg.cn/large/007S8ZIlly1gfoqomhiucj30i0073dg9.jpg&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;HTTP-请求报文&#34;&gt;&lt;a href=&#34;#HTTP-请求报文&#34; class=&#34;headerlink&#34; title=&#34;HTTP 请求报文&#34;&gt;&lt;/a&gt;&lt;strong&gt;HTTP&lt;/strong&gt; 请求报文&lt;/h3&gt;&lt;p&gt;在请求中，HTTP 报文由==方法==、==URI==、==HTTP 版本==、==HTTP 首部字段==等部分构成。&lt;/p&gt;
&lt;p&gt;下面的示例是访问 &lt;a href=&#34;http://hackr.jp/&#34;&gt;http://hackr.jp&lt;/a&gt; 时，&lt;code&gt;请求报文&lt;/code&gt;的首部信息。&lt;/p&gt;
&lt;figure class=&#34;highlight http&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;GET&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;/&lt;/span&gt; HTTP/1.1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;attribute&#34;&gt;Host&lt;/span&gt;: hackr.jp&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;attribute&#34;&gt;User-Agent&lt;/span&gt;: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:13.0) Ge Accept: text/html,application/xhtml+xml,application/xml;q=0. Accept-Language: ja,en-us;q=0.7,en;q=0.3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;attribute&#34;&gt;Accept-Encoding&lt;/span&gt;: gzip, deflate&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;attribute&#34;&gt;DNT&lt;/span&gt;: 1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;attribute&#34;&gt;Connection&lt;/span&gt;: keep-alive&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;attribute&#34;&gt;If-Modified-Since&lt;/span&gt;: Fri, 31 Aug 2007 02:02:20 GMT If-None-Match: &amp;quot;45bae1-16a-46d776ac&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;attribute&#34;&gt;Cache-Control&lt;/span&gt;: max-age=0&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&#34;HTTP-响应报文&#34;&gt;&lt;a href=&#34;#HTTP-响应报文&#34; class=&#34;headerlink&#34; title=&#34;HTTP 响应报文&#34;&gt;&lt;/a&gt;&lt;strong&gt;HTTP&lt;/strong&gt; 响应报文&lt;/h3&gt;&lt;p&gt;在响应中，HTTP 报文由 ==HTTP 版本==、==状态码(数字和原因短语)==、 ==HTTP 首部字段== 3 部分构成。&lt;/p&gt;
&lt;p&gt;以下示例是之前请求访问 &lt;a href=&#34;http://hackr.jp/&#34;&gt;http://hackr.jp/&lt;/a&gt; 时，&lt;code&gt;返回的响应报文&lt;/code&gt;的首部信息。&lt;/p&gt;
&lt;figure class=&#34;highlight http&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;HTTP/1.1 &lt;span class=&#34;number&#34;&gt;304&lt;/span&gt; Not Modified&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;attribute&#34;&gt;Date&lt;/span&gt;: Thu, 07 Jun 2012 07:21:36 GMT Server: Apache&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;attribute&#34;&gt;Connection&lt;/span&gt;: close&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;attribute&#34;&gt;Etag&lt;/span&gt;: &amp;quot;45bae1-16a-46d776ac&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h2 id=&#34;6-2-HTTP-首部字段&#34;&gt;&lt;a href=&#34;#6-2-HTTP-首部字段&#34; class=&#34;headerlink&#34; title=&#34;6.2 HTTP 首部字段&#34;&gt;&lt;/a&gt;&lt;strong&gt;6.2&lt;/strong&gt; &lt;strong&gt;HTTP&lt;/strong&gt; 首部字段&lt;/h2&gt;&lt;h3 id=&#34;6-2-1-HTTP-首部字段传递重要信息&#34;&gt;&lt;a href=&#34;#6-2-1-HTTP-首部字段传递重要信息&#34; class=&#34;headerlink&#34; title=&#34;6.2.1 HTTP 首部字段传递重要信息&#34;&gt;&lt;/a&gt;&lt;strong&gt;6.2.1&lt;/strong&gt; &lt;strong&gt;HTTP&lt;/strong&gt; 首部字段传递重要信息&lt;/h3&gt;&lt;p&gt;在客户端与服务器之间以 HTTP 协议进行通信的过程中，无论是请求还是响应都会使用首部字段，它能起到&lt;u&gt;传递额外重要信息&lt;/u&gt;的作用。&lt;/p&gt;
&lt;p&gt;使用首部字段是&lt;u&gt;为了给浏览器和服务器提供&lt;/u&gt;==报文主体大小==、==所使用的语言==、==认证信息==等内容。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://tva1.sinaimg.cn/large/007S8ZIlly1gfoqx2vkajj30jv08nt9h.jpg&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;6-2-2-HTTP-首部字段结构&#34;&gt;&lt;a href=&#34;#6-2-2-HTTP-首部字段结构&#34; class=&#34;headerlink&#34; title=&#34;6.2.2 HTTP 首部字段结构&#34;&gt;&lt;/a&gt;&lt;strong&gt;6.2.2&lt;/strong&gt; &lt;strong&gt;HTTP&lt;/strong&gt; 首部字段结构&lt;/h3&gt;&lt;p&gt;&lt;code&gt;首部字段名&lt;/code&gt;： &lt;code&gt;字段值&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;在 HTTP 首部中以 Content-Type 这个字段来表示报文主体的对象类型。  Content-Type: text/html&lt;/p&gt;
&lt;p&gt;字段值对应单个 HTTP 首部字段可以有多个值  —- Keep-Alive: timeout=15, max=100&lt;/p&gt;
&lt;h3 id=&#34;6-2-3-4-种-HTTP-首部字段类型&#34;&gt;&lt;a href=&#34;#6-2-3-4-种-HTTP-首部字段类型&#34; class=&#34;headerlink&#34; title=&#34;6.2.3  4 种 HTTP 首部字段类型&#34;&gt;&lt;/a&gt;6.2.3  &lt;strong&gt;4&lt;/strong&gt; 种 &lt;strong&gt;HTTP&lt;/strong&gt; 首部字段类型&lt;/h3&gt;&lt;p&gt;根据实际用途：&lt;/p&gt;
&lt;h4 id=&#34;通用首部字段-General-Header-Fields&#34;&gt;&lt;a href=&#34;#通用首部字段-General-Header-Fields&#34; class=&#34;headerlink&#34; title=&#34;通用首部字段(General Header Fields)&#34;&gt;&lt;/a&gt;通用首部字段(&lt;strong&gt;General Header Fields&lt;/strong&gt;)&lt;/h4&gt;&lt;p&gt;请求报文和响应报文两方都会使用的首部。&lt;/p&gt;
&lt;h4 id=&#34;请求首部字段-Request-Header-Fields&#34;&gt;&lt;a href=&#34;#请求首部字段-Request-Header-Fields&#34; class=&#34;headerlink&#34; title=&#34;请求首部字段(Request Header Fields)&#34;&gt;&lt;/a&gt;请求首部字段(&lt;strong&gt;Request Header Fields&lt;/strong&gt;)&lt;/h4&gt;&lt;p&gt;从客户端向服务器端发送请求报文时使用的首部。补充了请求的附加 内容、客户端信息、响应内容相关优先级等信息。&lt;/p&gt;
&lt;h4 id=&#34;响应首部字段-Response-Header-Fields&#34;&gt;&lt;a href=&#34;#响应首部字段-Response-Header-Fields&#34; class=&#34;headerlink&#34; title=&#34;响应首部字段(Response Header Fields)&#34;&gt;&lt;/a&gt;响应首部字段(&lt;strong&gt;Response Header Fields&lt;/strong&gt;)&lt;/h4&gt;&lt;p&gt;从服务器端向客户端返回响应报文时使用的首部。补充了响应的附加内容，也会要求客户端附加额外的内容信息。 &lt;/p&gt;
&lt;h4 id=&#34;实体首部字段-Entity-Header-Fields&#34;&gt;&lt;a href=&#34;#实体首部字段-Entity-Header-Fields&#34; class=&#34;headerlink&#34; title=&#34;实体首部字段(Entity Header Fields)&#34;&gt;&lt;/a&gt;实体首部字段(&lt;strong&gt;Entity Header Fields&lt;/strong&gt;)&lt;/h4&gt;&lt;p&gt;针对请求报文和响应报文的实体部分使用的首部。补充了资源内容更 新时间等与实体有关的信息。&lt;/p&gt;
&lt;h3 id=&#34;6-2-4-HTTP-1-1-首部字段一览&#34;&gt;&lt;a href=&#34;#6-2-4-HTTP-1-1-首部字段一览&#34; class=&#34;headerlink&#34; title=&#34;6.2.4 HTTP/1.1 首部字段一览&#34;&gt;&lt;/a&gt;&lt;strong&gt;6.2.4&lt;/strong&gt; &lt;strong&gt;HTTP/1.1&lt;/strong&gt; 首部字段一览&lt;/h3&gt;&lt;p&gt;&lt;img src=&#34;https://tva1.sinaimg.cn/large/007S8ZIlly1gfor11o3avj30e40abq3r.jpg&#34;&gt;&lt;/p&gt;
&lt;p&gt;​                                                    请求首部字段&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://tva1.sinaimg.cn/large/007S8ZIlly1gfor16d6tfj30fp0hotav.jpg&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://tva1.sinaimg.cn/large/007S8ZIlly1gfor1mqeq8j30et0a8t9q.jpg&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://tva1.sinaimg.cn/large/007S8ZIlly1gfor1v4q78j30e30b6q41.jpg&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;6-2-5-非-HTTP-1-1-首部字段&#34;&gt;&lt;a href=&#34;#6-2-5-非-HTTP-1-1-首部字段&#34; class=&#34;headerlink&#34; title=&#34;6.2.5 非 HTTP/1.1 首部字段&#34;&gt;&lt;/a&gt;&lt;strong&gt;6.2.5&lt;/strong&gt; 非 &lt;strong&gt;HTTP/1.1&lt;/strong&gt; 首部字段&lt;/h3&gt;&lt;p&gt;还有 Cookie、Set-Cookie 和 Content-Disposition 等在其他 RFC 中定义的首部字段，它们的使用频率也很高。&lt;/p&gt;
&lt;p&gt;这些非正式的首部字段统一归纳在 RFC4229 HTTP Header Field Registrations 中。&lt;/p&gt;
&lt;h3 id=&#34;6-2-6-End-to-end-首部和-Hop-by-hop-首部&#34;&gt;&lt;a href=&#34;#6-2-6-End-to-end-首部和-Hop-by-hop-首部&#34; class=&#34;headerlink&#34; title=&#34;6.2.6 End-to-end 首部和 Hop-by-hop 首部&#34;&gt;&lt;/a&gt;&lt;strong&gt;6.2.6&lt;/strong&gt; &lt;strong&gt;End-to-end&lt;/strong&gt; 首部和 &lt;strong&gt;Hop-by-hop&lt;/strong&gt; 首部&lt;/h3&gt;&lt;p&gt;HTTP 首部字段将定义成&lt;code&gt;缓存代理&lt;/code&gt;和&lt;code&gt;非缓存代理&lt;/code&gt;的行为，分成 2 种类型。&lt;/p&gt;
&lt;h4 id=&#34;端到端首部-End-to-end-Header&#34;&gt;&lt;a href=&#34;#端到端首部-End-to-end-Header&#34; class=&#34;headerlink&#34; title=&#34;端到端首部(End-to-end Header)&#34;&gt;&lt;/a&gt;端到端首部(&lt;strong&gt;End-to-end Header&lt;/strong&gt;)&lt;/h4&gt;&lt;p&gt;分在此类别中的首部会转发给请求 / 响应对应的最终接收目标，且必须保存在由缓存生成的响应中，另外规定它必须被转发。&lt;/p&gt;
&lt;h4 id=&#34;逐跳首部-Hop-by-hop-Header&#34;&gt;&lt;a href=&#34;#逐跳首部-Hop-by-hop-Header&#34; class=&#34;headerlink&#34; title=&#34;逐跳首部(Hop-by-hop Header)&#34;&gt;&lt;/a&gt;逐跳首部(&lt;strong&gt;Hop-by-hop Header&lt;/strong&gt;)&lt;/h4&gt;&lt;p&gt;分在此类别中的首部只对单次转发有效，会因通过缓存或代理而不再转发。HTTP/1.1 和之后版本中，如果要使用 hop-by-hop 首部，需提供 Connection 首部字段。&lt;/p&gt;
&lt;p&gt;下面列举了 HTTP/1.1 中的逐跳首部字段。除这 8 个首部字段之外， 其他所有字段都属于端到端首部。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Connection&lt;/li&gt;
&lt;li&gt;Keep-Alive&lt;/li&gt;
&lt;li&gt;Proxy-Authenticate &lt;/li&gt;
&lt;li&gt;Proxy-Authorization &lt;/li&gt;
&lt;li&gt;Trailer&lt;/li&gt;
&lt;li&gt;TE&lt;/li&gt;
&lt;li&gt;Transfe r-Encoding &lt;/li&gt;
&lt;li&gt;Upgrade&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;6-3-HTTP-1-1-通用首部字段&#34;&gt;&lt;a href=&#34;#6-3-HTTP-1-1-通用首部字段&#34; class=&#34;headerlink&#34; title=&#34;6.3 HTTP/1.1 通用首部字段&#34;&gt;&lt;/a&gt;&lt;strong&gt;6.3&lt;/strong&gt; &lt;strong&gt;HTTP/1.1&lt;/strong&gt; 通用首部字段&lt;/h2&gt;&lt;h3 id=&#34;6-3-1-Cache-Control&#34;&gt;&lt;a href=&#34;#6-3-1-Cache-Control&#34; class=&#34;headerlink&#34; title=&#34;6.3.1 Cache-Control&#34;&gt;&lt;/a&gt;&lt;strong&gt;6.3.1&lt;/strong&gt; Cache-Control&lt;/h3&gt;&lt;p&gt;通过指定首部字段 Cache-Control 的指令，就能操作缓存的工作机 制。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://tva1.sinaimg.cn/large/007S8ZIlly1gfor6f14pwj30j207ut98.jpg&#34;&gt;&lt;/p&gt;
&lt;p&gt;指令的参数是可选的，多个指令之间通过“,”分隔。首部字段 Cache-Control 的指令可用于请求及响应时。&lt;/p&gt;
&lt;figure class=&#34;highlight http&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;attribute&#34;&gt;Cache-Control&lt;/span&gt;: private, max-age=0, no-cache&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h4 id=&#34;Cache-Control-指令一览&#34;&gt;&lt;a href=&#34;#Cache-Control-指令一览&#34; class=&#34;headerlink&#34; title=&#34;Cache-Control 指令一览&#34;&gt;&lt;/a&gt;&lt;strong&gt;Cache-Control&lt;/strong&gt; 指令一览&lt;/h4&gt;&lt;p&gt;&lt;img src=&#34;https://tva1.sinaimg.cn/large/007S8ZIlly1gfor7jaab4j30f609fmy4.jpg&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://tva1.sinaimg.cn/large/007S8ZIlly1gfor7tnfgij30ji0bfq4i.jpg&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;表示是否能缓存的指令-public-指令&#34;&gt;&lt;a href=&#34;#表示是否能缓存的指令-public-指令&#34; class=&#34;headerlink&#34; title=&#34;表示是否能缓存的指令 public 指令&#34;&gt;&lt;/a&gt;表示是否能缓存的指令 &lt;strong&gt;public&lt;/strong&gt; 指令&lt;/h4&gt;&lt;p&gt;当指定使用 public 指令时，则明确表明其他用户也可利用缓存&lt;/p&gt;
&lt;figure class=&#34;highlight http&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;attribute&#34;&gt;Cache-Control&lt;/span&gt;: public&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h4 id=&#34;private-指令&#34;&gt;&lt;a href=&#34;#private-指令&#34; class=&#34;headerlink&#34; title=&#34;private 指令&#34;&gt;&lt;/a&gt;&lt;strong&gt;private&lt;/strong&gt; 指令&lt;/h4&gt;&lt;p&gt;响应只以特定的用户作为对象，这与 public 指令的行为相反。缓存服务器会对该特定用户提供资源缓存的服务，对于其他用户发送 过来的请求，代理服务器则不会返回缓存。&lt;/p&gt;
&lt;figure class=&#34;highlight http&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;attribute&#34;&gt;Cache-Control&lt;/span&gt;: private&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;&lt;img src=&#34;https://tva1.sinaimg.cn/large/007S8ZIlly1gfor8yt220j30ik07374r.jpg&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;no-cache-指令&#34;&gt;&lt;a href=&#34;#no-cache-指令&#34; class=&#34;headerlink&#34; title=&#34;no-cache 指令&#34;&gt;&lt;/a&gt;&lt;strong&gt;no-cache&lt;/strong&gt; 指令&lt;/h4&gt;"> <!-- TODO: truncate -->
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="atom.xml" rel="alternate" title="Amorki&#39;s" type="application/atom+xml">
	<link href="/favicon.ico" rel="shortcut icon">
    <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
    <link href="/stylesheets/custom.css" media="screen, projection" rel="stylesheet" type="text/css">
    <link href="/stylesheets/hljs.css" media="screen, projection" rel="stylesheet" type="text/css">

    <link href='//fonts.googleapis.com/css?family=Slackey' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Fjalla+One' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Amethysta' rel='stylesheet' type='text/css'>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![}]-->

    <script type="text/javascript" src="/javascripts/jquery-tapir.js"></script>

    <!-- remove or comment it to disable ajaxification -->   
    <!-- <script src="/javascripts/ajaxify.js"></script> -->

    

    

<meta name="generator" content="Hexo 5.0.0"></head>


<body>
    <div id="wrapper">
    <header id="header" class="inner"><!-- for more effects see _animate.scss -->
<h1 class="animated bounceInDown">
    <div id="headerbg">
        Amorki&#39;s
    </div>
</h1>
<span class="subtitle"></span>
<br>

<ul id="social-links" style="text-align:center; clear:both;">
    
        <!-- GitHub -->
        <li>
            <a target="_blank" rel="noopener" href="https://github.com/amorkiki" class="github" title="Github"></a>
        </li>
        
            
                    
                        <!-- Facebook -->
                        <li>
                            <a target="_blank" rel="noopener" href="http://www.facebook.com/kiki.wu.92167789" class="facebook" title="Facebook"></a>
                        </li>
                        
                            
                                <!-- Twitter -->
                                <li>
                                    <a target="_blank" rel="noopener" href="http://www.twitter.com/BENICEXKiki" class="twitter" title="Twitter"></a>
                                </li>
                                
                                    
                                            
                                                    
                                                            
                                                                <!-- Instagram -->
                                                                <li>
                                                                    <a target="_blank" rel="noopener" href="http://www.instagram.com/wuuuuuujt" class="instagram" title="Instagram"></a>
                                                                </li>

                                                                
</ul>

<!-- use full url including 'index.html' for navigation bar if you are using ajax -->
<ul id="nav">
	<li id="ajax"><a href="/index.html">Home</a></li>
	<li id="ajax"><a href="/archives/index.html">Archives</a></li>
	<li id="ajax"><a href="/tags/index.html">Tags</a></li>
    <li><a href="/atom.xml">RSS</a></li>
    
    <li>
    <div id="dark">
        <form action="//www.google.com.hk/search" method="get" accept-charset="UTF-8" id="search">
            <input type="hidden" name="sitesearch" value="http://yoursite.com" />
            <input type="text" name="q" results="0" placeholder="Search..." x-webkit-speech />
        </form>
    </div>
    </li>
        
</ul>




</header>

<div id="toload">
<!-- begin toload -->
    <div id="content" class="inner">
        <article class="post">
	<h2 class="title">http_ReadNotes-04</h2>
    <div class="meta">
        <div class="date">Published on: <time datetime="2019-07-18T15:21:26.000Z" itemprop="datePublished">Jul 18, 2019</time>
</div>
        <div class="tags">Tags: 

<a href="/tags/ReadNotes/">ReadNotes</a> <a href="/tags/http/">http</a>
</div>
    </div>
	<div class="entry-content"><h1 id="V-与HTTP协作的Web服务器"><a href="#V-与HTTP协作的Web服务器" class="headerlink" title="V. 与HTTP协作的Web服务器"></a>V. 与HTTP协作的Web服务器</h1><p>一台 Web 服务器可搭建多个独立域名的 Web 网站，也可作为通信路 径上的中转服务器提升传输效率。</p>
<h2 id="5-1-用单台虚拟主机实现多个域名"><a href="#5-1-用单台虚拟主机实现多个域名" class="headerlink" title="5.1 用单台虚拟主机实现多个域名"></a><strong>5.1</strong> 用单台虚拟主机实现多个域名</h2><p>HTTP/1.1 规范允许一台 HTTP 服务器搭建多个 Web 站点。</p>
<p>提供 Web 托管服务(Web Hosting Service)的供应商，可以用一台服务器为多位客户服务，也可以以每位客户持有的域名运行各自不同的网站。这是因为利用了<code>虚拟主机</code>(Virtual Host，又称虚拟服务器)的功能。</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfopwi7vkgj30i30d5dgt.jpg"></p>
<p>客户端使用 HTTP 协议访问服务器时，会经常采用类似 <a target="_blank" rel="noopener" href="http://www.hackr.jp/">www.hackr.jp</a> 这样的主机名和域名。</p>
<p>在互联网上，域名通过 DNS 服务映射到 IP 地址(域名解析)之后访问目标网站。</p>
<p>当请求发送到服务器时，已经是以 IP 地址形式访问了。</p>
<p>所以，如果一台服务器内托管了 <a target="_blank" rel="noopener" href="http://www.tricorder.jp/">www.tricorder.jp</a> 和 <a target="_blank" rel="noopener" href="http://www.hackr.jp/">www.hackr.jp</a> 这 两个域名，当收到请求时就需要弄清楚究竟要访问哪个域名。</p>
<p>在相同的 IP 地址下，由于虚拟主机可以寄存多个不同主机名和域名 的 Web 网站，因此在发送 HTTP 请求时，必须在 Host 首部内完整指 定主机名或域名的 URI。</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfopyxahuqj30ev09omxy.jpg"></p>
<h2 id="5-2-通信数据转发程序-代理、网关、隧道"><a href="#5-2-通信数据转发程序-代理、网关、隧道" class="headerlink" title="5.2 通信数据转发程序 :代理、网关、隧道"></a><strong>5.2</strong> 通信数据转发程序 :代理、网关、隧道</h2><p>HTTP 通信时，除客户端和服务器以外，还有一些用于<code>通信数据转发的应用程序</code>可以配合服务器工作。</p>
<p>将请求转发给通信线路上的下一站服务器，并且能接收从那台服务器发送的响应再转发给客户端。</p>
<h3 id="代理"><a href="#代理" class="headerlink" title="代理"></a>代理</h3><p>代理是一种<code>有转发功能的应用程序</code>，它扮演了位于服务器和客户端“中间人”的角色，接收由客户端发送的请求并转发给服务器，同时 也接收服务器返回的响应并转发给客户端。</p>
<ul>
<li>代理不改变请求 URI，会直接发送给前方持有资源的目标服务器。</li>
<li>持有资源实体的服务器被称为源服务器。从源服务器返回的响应经过 代理服务器后再传给客户端。</li>
<li>在 HTTP 通信过程中，可级联多台代理服务器。请求和响应的转发会 经过数台类似锁链一样连接起来的代理服务器。</li>
<li>转发时，需要附加 Via 首部字段以标记出经过的主机信息。</li>
</ul>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfoq5962glj30jl07d0tk.jpg"></p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfoq6k52ppj30j2084q42.jpg"></p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfoq7m3detj30g4079wf1.jpg"></p>
<p>使用代理服务器的理由:</p>
<ul>
<li>利用缓存技术减少网络带宽的流量，</li>
<li>组织内部针对特定网站的访问控制，以获取访问日志为主要目的</li>
</ul>
<p>代理有多种使用方法：</p>
<ul>
<li>是否使用缓存</li>
<li>是否会修改报文</li>
</ul>
<p><code>缓存代理</code></p>
<p>代理转发响应时，缓存代理(Caching Proxy)会预先将资源的副本 (缓存)保存在代理服务器上。</p>
<p>当代理再次接收到对相同资源的请求时，就可以不从源服务器那里获取资源，而是将之前缓存的资源作为响应返回。</p>
<p><code>透明代理</code></p>
<p>转发请求或响应时，不对报文做任何加工的代理类型被称为透明代理 (Transparent Proxy)。反之，对报文内容进行加工的代理被称为非 透明代理。</p>
<h3 id="网关"><a href="#网关" class="headerlink" title="网关"></a>网关</h3><p>网关是<code>转发其他服务器通信数据的服务器</code>，接收从客户端发送来的请求时，它就像自己拥有资源的源服务器一样对请求进行处理。有时客户端可能都不会察觉，自己的通信目标是一个网关。</p>
<ul>
<li>网关能使通信线路上的服务器提供非 HTTP 协议服务。</li>
<li>利用网关能提高通信的安全性，在客户端与网关之间的通信线路上加密确保连接的安全。</li>
<li>网关可以连接数据库，使用 SQL 语句查询数据。</li>
<li>在 Web 购物网站上进行信用卡结算时， 网关可以和信用卡结算系统联动。</li>
</ul>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfoq9mopetj30ii05jdg7.jpg"></p>
<h3 id="隧道"><a href="#隧道" class="headerlink" title="隧道"></a>隧道</h3><p>隧道是在<code>相隔甚远的客户端和服务器两者之间进行中转</code>，并保持双方通信连接的应用程序。</p>
<ul>
<li>届时使用 SSL 等加密手段进行通信。</li>
<li>目的是确保客户端能与服务器进行安全的通信。</li>
<li>隧道本身不会去解析 HTTP 请求。—–请求保持原样中转给之后的服务器。</li>
<li>隧道会在通信双方断开连接时结束。</li>
<li>隧道本身是透明的，客户端不用在意隧道的存在</li>
</ul>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfoqfvvnzoj30j204fwes.jpg"></p>
<h2 id="5-3-保存资源的缓存"><a href="#5-3-保存资源的缓存" class="headerlink" title="5.3 保存资源的缓存"></a><strong>5.3</strong> 保存资源的缓存</h2><p><code>缓存</code>——代理服务器或客户端本地磁盘内保存的资源副本。</p>
<p>利用缓存可减少对源服务器的访问，节省通信流量和通信时间。</p>
<p><code>缓存服务器</code>是代理服务器的一种，并归类在缓存代理类型中。</p>
<p>当代理转发从服务器返回的响应时，代理服务器将会保存一份资 源的副本。</p>
<p>利用缓存可避免多次从源服务器转发资源。</p>
<p>客户端可就近从缓存服务器上获取资源，而源服务器也不必多次处 理相同的请求了。</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfoqjp2bohj30jr0hlwg7.jpg"></p>
<h3 id="5-3-1-缓存的有效期限"><a href="#5-3-1-缓存的有效期限" class="headerlink" title="5.3.1 缓存的有效期限"></a><strong>5.3.1</strong> 缓存的有效期限</h3><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfoql8swl0j30jm0amjsa.jpg"></p>
<h3 id="5-3-2-客户端的缓存"><a href="#5-3-2-客户端的缓存" class="headerlink" title="5.3.2 客户端的缓存"></a><strong>5.3.2</strong> 客户端的缓存</h3><p>缓存不仅可以存在于缓存服务器内，还可以存在客户端浏览器中。</p>
<p>以 <code>Internet Explorer</code> 程序为例，把客户端缓存称为<code>临时网络文件</code> (Temporary Internet File)。</p>
<p>浏览器缓存如果有效，就不必再向服务器请求相同的资源了，可以直 接从本地磁盘内读取。</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfoqmly6c7j30dz0a2mxm.jpg"></p>
<h2 id="在-HTTP-出现之前的协议"><a href="#在-HTTP-出现之前的协议" class="headerlink" title="在 HTTP 出现之前的协议"></a>在 <strong>HTTP</strong> 出现之前的协议</h2><blockquote>
<p>在 HTTP 普及之前，也就是从互联网的诞生期至今，曾出现过各式各样的协议。在 HTTP 规范确立之际，制定者们参考了那些协议的 功能。也有某些协议现在已经彻底退出了人们的视线。接下来，简单介绍一下这些协议。</p>
<p><strong>FTP</strong>(<strong>File Transfer Protocol</strong>)</p>
<p>传输文件时使用的协议。该协议历史久远，可追溯到 1973 年前 后，比 TCP/IP 协议族的出现还要早。虽然它在 1995 年被 HTTP 的 流量(Traffic)超越，但时至今日，仍被广泛沿用。</p>
<p><strong>NNTP</strong>(<strong>Network News Transfer Protocol</strong>)</p>
<p>用于 NetNews 电子会议室内传送消息的协议。在 1986 年前后出 现，属于比较古老的一类协议。现在，利用 Web 交换信息已成主 流，所以该协议已经不怎么使用了。</p>
<p><strong>Archie</strong></p>
<p>搜索 anonymous FTP 公开的文件信息的协议。1990 年前后出现，现 在已经不常使用。</p>
<p><strong>WAIS</strong>(<strong>Wide Area Information Servers</strong>) 以关键词检索多个数据库使用的协议。1991 年前后出现。由于现</p>
<p>在已经被 HTTP 协议替代，也已经不怎么使用了。 <strong>G o phe r</strong></p>
<p>查找与互联网连接的计算机内信息的协议。1991 年前后出现，由 于现在已经被 HTTP 协议替代，也已经不怎么使用了。</p>
</blockquote>
<h1 id="VI-HTTP-首部"><a href="#VI-HTTP-首部" class="headerlink" title="VI. HTTP 首部"></a>VI. HTTP 首部</h1><h2 id="6-1-HTTP-报文首部"><a href="#6-1-HTTP-报文首部" class="headerlink" title="6.1 HTTP 报文首部"></a><strong>6.1</strong> <strong>HTTP</strong> 报文首部</h2><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfoqomhiucj30i0073dg9.jpg"></p>
<h3 id="HTTP-请求报文"><a href="#HTTP-请求报文" class="headerlink" title="HTTP 请求报文"></a><strong>HTTP</strong> 请求报文</h3><p>在请求中，HTTP 报文由==方法==、==URI==、==HTTP 版本==、==HTTP 首部字段==等部分构成。</p>
<p>下面的示例是访问 <a target="_blank" rel="noopener" href="http://hackr.jp/">http://hackr.jp</a> 时，<code>请求报文</code>的首部信息。</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: hackr.jp</span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:13.0) Ge Accept: text/html,application/xhtml+xml,application/xml;q=0. Accept-Language: ja,en-us;q=0.7,en;q=0.3</span><br><span class="line"><span class="attribute">Accept-Encoding</span>: gzip, deflate</span><br><span class="line"><span class="attribute">DNT</span>: 1</span><br><span class="line"><span class="attribute">Connection</span>: keep-alive</span><br><span class="line"><span class="attribute">If-Modified-Since</span>: Fri, 31 Aug 2007 02:02:20 GMT If-None-Match: &quot;45bae1-16a-46d776ac&quot;</span><br><span class="line"><span class="attribute">Cache-Control</span>: max-age=0</span><br></pre></td></tr></table></figure>

<h3 id="HTTP-响应报文"><a href="#HTTP-响应报文" class="headerlink" title="HTTP 响应报文"></a><strong>HTTP</strong> 响应报文</h3><p>在响应中，HTTP 报文由 ==HTTP 版本==、==状态码(数字和原因短语)==、 ==HTTP 首部字段== 3 部分构成。</p>
<p>以下示例是之前请求访问 <a target="_blank" rel="noopener" href="http://hackr.jp/">http://hackr.jp/</a> 时，<code>返回的响应报文</code>的首部信息。</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 <span class="number">304</span> Not Modified</span><br><span class="line"><span class="attribute">Date</span>: Thu, 07 Jun 2012 07:21:36 GMT Server: Apache</span><br><span class="line"><span class="attribute">Connection</span>: close</span><br><span class="line"><span class="attribute">Etag</span>: &quot;45bae1-16a-46d776ac&quot;</span><br></pre></td></tr></table></figure>

<h2 id="6-2-HTTP-首部字段"><a href="#6-2-HTTP-首部字段" class="headerlink" title="6.2 HTTP 首部字段"></a><strong>6.2</strong> <strong>HTTP</strong> 首部字段</h2><h3 id="6-2-1-HTTP-首部字段传递重要信息"><a href="#6-2-1-HTTP-首部字段传递重要信息" class="headerlink" title="6.2.1 HTTP 首部字段传递重要信息"></a><strong>6.2.1</strong> <strong>HTTP</strong> 首部字段传递重要信息</h3><p>在客户端与服务器之间以 HTTP 协议进行通信的过程中，无论是请求还是响应都会使用首部字段，它能起到<u>传递额外重要信息</u>的作用。</p>
<p>使用首部字段是<u>为了给浏览器和服务器提供</u>==报文主体大小==、==所使用的语言==、==认证信息==等内容。</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfoqx2vkajj30jv08nt9h.jpg"></p>
<h3 id="6-2-2-HTTP-首部字段结构"><a href="#6-2-2-HTTP-首部字段结构" class="headerlink" title="6.2.2 HTTP 首部字段结构"></a><strong>6.2.2</strong> <strong>HTTP</strong> 首部字段结构</h3><p><code>首部字段名</code>： <code>字段值</code></p>
<p>在 HTTP 首部中以 Content-Type 这个字段来表示报文主体的对象类型。  Content-Type: text/html</p>
<p>字段值对应单个 HTTP 首部字段可以有多个值  —- Keep-Alive: timeout=15, max=100</p>
<h3 id="6-2-3-4-种-HTTP-首部字段类型"><a href="#6-2-3-4-种-HTTP-首部字段类型" class="headerlink" title="6.2.3  4 种 HTTP 首部字段类型"></a>6.2.3  <strong>4</strong> 种 <strong>HTTP</strong> 首部字段类型</h3><p>根据实际用途：</p>
<h4 id="通用首部字段-General-Header-Fields"><a href="#通用首部字段-General-Header-Fields" class="headerlink" title="通用首部字段(General Header Fields)"></a>通用首部字段(<strong>General Header Fields</strong>)</h4><p>请求报文和响应报文两方都会使用的首部。</p>
<h4 id="请求首部字段-Request-Header-Fields"><a href="#请求首部字段-Request-Header-Fields" class="headerlink" title="请求首部字段(Request Header Fields)"></a>请求首部字段(<strong>Request Header Fields</strong>)</h4><p>从客户端向服务器端发送请求报文时使用的首部。补充了请求的附加 内容、客户端信息、响应内容相关优先级等信息。</p>
<h4 id="响应首部字段-Response-Header-Fields"><a href="#响应首部字段-Response-Header-Fields" class="headerlink" title="响应首部字段(Response Header Fields)"></a>响应首部字段(<strong>Response Header Fields</strong>)</h4><p>从服务器端向客户端返回响应报文时使用的首部。补充了响应的附加内容，也会要求客户端附加额外的内容信息。 </p>
<h4 id="实体首部字段-Entity-Header-Fields"><a href="#实体首部字段-Entity-Header-Fields" class="headerlink" title="实体首部字段(Entity Header Fields)"></a>实体首部字段(<strong>Entity Header Fields</strong>)</h4><p>针对请求报文和响应报文的实体部分使用的首部。补充了资源内容更 新时间等与实体有关的信息。</p>
<h3 id="6-2-4-HTTP-1-1-首部字段一览"><a href="#6-2-4-HTTP-1-1-首部字段一览" class="headerlink" title="6.2.4 HTTP/1.1 首部字段一览"></a><strong>6.2.4</strong> <strong>HTTP/1.1</strong> 首部字段一览</h3><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfor11o3avj30e40abq3r.jpg"></p>
<p>​                                                    请求首部字段</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfor16d6tfj30fp0hotav.jpg"></p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfor1mqeq8j30et0a8t9q.jpg"></p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfor1v4q78j30e30b6q41.jpg"></p>
<h3 id="6-2-5-非-HTTP-1-1-首部字段"><a href="#6-2-5-非-HTTP-1-1-首部字段" class="headerlink" title="6.2.5 非 HTTP/1.1 首部字段"></a><strong>6.2.5</strong> 非 <strong>HTTP/1.1</strong> 首部字段</h3><p>还有 Cookie、Set-Cookie 和 Content-Disposition 等在其他 RFC 中定义的首部字段，它们的使用频率也很高。</p>
<p>这些非正式的首部字段统一归纳在 RFC4229 HTTP Header Field Registrations 中。</p>
<h3 id="6-2-6-End-to-end-首部和-Hop-by-hop-首部"><a href="#6-2-6-End-to-end-首部和-Hop-by-hop-首部" class="headerlink" title="6.2.6 End-to-end 首部和 Hop-by-hop 首部"></a><strong>6.2.6</strong> <strong>End-to-end</strong> 首部和 <strong>Hop-by-hop</strong> 首部</h3><p>HTTP 首部字段将定义成<code>缓存代理</code>和<code>非缓存代理</code>的行为，分成 2 种类型。</p>
<h4 id="端到端首部-End-to-end-Header"><a href="#端到端首部-End-to-end-Header" class="headerlink" title="端到端首部(End-to-end Header)"></a>端到端首部(<strong>End-to-end Header</strong>)</h4><p>分在此类别中的首部会转发给请求 / 响应对应的最终接收目标，且必须保存在由缓存生成的响应中，另外规定它必须被转发。</p>
<h4 id="逐跳首部-Hop-by-hop-Header"><a href="#逐跳首部-Hop-by-hop-Header" class="headerlink" title="逐跳首部(Hop-by-hop Header)"></a>逐跳首部(<strong>Hop-by-hop Header</strong>)</h4><p>分在此类别中的首部只对单次转发有效，会因通过缓存或代理而不再转发。HTTP/1.1 和之后版本中，如果要使用 hop-by-hop 首部，需提供 Connection 首部字段。</p>
<p>下面列举了 HTTP/1.1 中的逐跳首部字段。除这 8 个首部字段之外， 其他所有字段都属于端到端首部。</p>
<ul>
<li>Connection</li>
<li>Keep-Alive</li>
<li>Proxy-Authenticate </li>
<li>Proxy-Authorization </li>
<li>Trailer</li>
<li>TE</li>
<li>Transfe r-Encoding </li>
<li>Upgrade</li>
</ul>
<h2 id="6-3-HTTP-1-1-通用首部字段"><a href="#6-3-HTTP-1-1-通用首部字段" class="headerlink" title="6.3 HTTP/1.1 通用首部字段"></a><strong>6.3</strong> <strong>HTTP/1.1</strong> 通用首部字段</h2><h3 id="6-3-1-Cache-Control"><a href="#6-3-1-Cache-Control" class="headerlink" title="6.3.1 Cache-Control"></a><strong>6.3.1</strong> Cache-Control</h3><p>通过指定首部字段 Cache-Control 的指令，就能操作缓存的工作机 制。</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfor6f14pwj30j207ut98.jpg"></p>
<p>指令的参数是可选的，多个指令之间通过“,”分隔。首部字段 Cache-Control 的指令可用于请求及响应时。</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Cache-Control</span>: private, max-age=0, no-cache</span><br></pre></td></tr></table></figure>

<h4 id="Cache-Control-指令一览"><a href="#Cache-Control-指令一览" class="headerlink" title="Cache-Control 指令一览"></a><strong>Cache-Control</strong> 指令一览</h4><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfor7jaab4j30f609fmy4.jpg"></p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfor7tnfgij30ji0bfq4i.jpg"></p>
<h4 id="表示是否能缓存的指令-public-指令"><a href="#表示是否能缓存的指令-public-指令" class="headerlink" title="表示是否能缓存的指令 public 指令"></a>表示是否能缓存的指令 <strong>public</strong> 指令</h4><p>当指定使用 public 指令时，则明确表明其他用户也可利用缓存</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Cache-Control</span>: public</span><br></pre></td></tr></table></figure>

<h4 id="private-指令"><a href="#private-指令" class="headerlink" title="private 指令"></a><strong>private</strong> 指令</h4><p>响应只以特定的用户作为对象，这与 public 指令的行为相反。缓存服务器会对该特定用户提供资源缓存的服务，对于其他用户发送 过来的请求，代理服务器则不会返回缓存。</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Cache-Control</span>: private</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfor8yt220j30ik07374r.jpg"></p>
<h4 id="no-cache-指令"><a href="#no-cache-指令" class="headerlink" title="no-cache 指令"></a><strong>no-cache</strong> 指令</h4></div>

<div class="meta">
	
</div>
</article>

	<div class="share">
	<div class="addthis_toolbox addthis_default_style ">
	
	
	<a class="addthis_button_tweet"></a>
	
	
	<a class="addthis_counter addthis_pill_style"></a>
	</div>
  <script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#pubid="></script>
</div>




    </div>
    <footer id="footer">
    <div style="display:inline">
    Copyright &copy; 2020

    JTW
. Powered by <a href="http://zespia.tw/hexo/" target="_blank">Hexo</a> |
    Theme is <a target="_blank" rel="noopener" href="https://github.com/wd/hexo-fabric">hexo-fabric</a>, fork from <a target="_blank" rel="noopener" href="http://github.com/panks/fabric">fabric</a> by <a target="_blank" rel="noopener" href="http://panks.me">Pankaj Kumar</a>
</div>


    </footer>
    <script src="/javascripts/fabric.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script>
 <!-- Delete or comment this line to disable Fancybox -->



<!-- end toload --> 
</div>
</div>
<script src="/javascripts/jquery.ui.totop.js" type="text/javascript"></script>
<script type="text/javascript">
/*<![CDATA[*/
;(function($){$().UItoTop({easingType:'easeOutCirc'});})(jQuery); 
/*]]>*/
</script><!-- remove it to remove the scroll to top button -->
</body>
</html>
